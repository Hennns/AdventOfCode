
object Main extends App{
  val puzzleInput: String = s"""
                       |.#....#..##.#..####....#.......
                       |......#..#....#....###......#.#
                       |#..#.....#..............##.#.#.
                       |#.#...#....#...#......##..#..#.
                       |...#..#.##..#..#........###.#.#
                       |...#.#..........#.........##...
                       |...#.#....#.#....#..#......#...
                       |..##.#.....#.......#.###..#..##
                       |..#.......#.......#....##......
                       |....##........##.##...#.###.##.
                       |#.......#.......##..#......#...
                       |..##.............##.#......#...
                       |...#.####....#.....#...##......
                       |.............##.#......#.......
                       |..#...#....#......#....#.......
                       |..#....#..#............#.......
                       |##...#..#........##..#......#..
                       |##........##........#.#.......#
                       |#.......#........#.#..#....###.
                       |.....#..#.#..........##...#....
                       |..##...#......#.#...#..#...#...
                       |##.##...#......#....#....#...#.
                       |#.......#..#.#..#....#..###.#.#
                       |#.............#.#....#..#.#....
                       |...#.......###.#.##.##.#...#..#
                       |.##.......##..##...#..###......
                       |.......#.#.#.#..####..#..#..#..
                       |...##......#.#.##.###....#.###.
                       |###......###......#.#####..#...
                       |..#........##..#..##.##..#...#.
                       |.....##..#...#..#.##.....#.#...
                       |#......#.##....#..##.#....#.#..
                       |##.#.##..#................#....
                       |......#.#....#......##.....#...
                       |..#...##..#..#...#..#.#..#.....
                       |........#.#.#.##...#.#.....#.#.
                       |#.#......#.....##..#...#.......
                       |..#.#......#...........###.....
                       |......##....#....##..#..#.#.#.#
                       |##....#.###...#......#..#...#..
                       |#.#.##....###...####.......#..#
                       |##...........#.....#........#.#
                       |.##.#..#.....#......#.......#..
                       |##..##..###....#.........##....
                       |..#..#..#.##...#.#...#........#
                       |#.##.###...#.......#...........
                       |.........#.................#...
                       |#.##...#.....#..##........#....
                       |....#.#...##...#...........#...
                       |.#.....#.#..#...##..##.....#...
                       |.#.....####....#..##..#........
                       |...#..#......##.#..##.#.#.#..#.
                       |.##.#.....#.....#...#.......##.
                       |......#..#..#......#...####....
                       |.......#......##..#..##.....#..
                       |......#.#..#...#..#.#..........
                       |....##.........#...............
                       |.#....#..##.....#....##.##.....
                       |#.#.....#...#....####....#.#...
                       |#.....#....#.#...#.............
                       |...#..#.....#....##..#..#......
                       |...#.#............#...........#
                       |###.#..#.#......#.....##.....#.
                       |####....#....###.....#..#.#####
                       |.###..#...#.#..#......##.#.#.#.
                       |.....#.##.#....#..##....#..#..#
                       |...#....#...##.....#......#.#..
                       |....#...#....#...#....#.....#.#
                       |.#.....#.....#.#..#......#..#..
                       |..#..##....##.##....#.....##...
                       |#..##...#.##...#..#.#.#.....#..
                       |...#..##.#..#....#.#....######.
                       |..........#..#.....#....#...##.
                       |#.#####.#.###..#.....#.........
                       |#....#......#..#.#.##.##..###..
                       |..#...###.#.#....##.##...##....
                       |.......#....#..#...##......#...
                       |...#.#...#..#.....#..##.#......
                       |###..##...........#............
                       |..#....#.##....#.#..##...#.....
                       |##....#...#....#.....#.#..##...
                       |..............#.##.#..#..##.###
                       |......#..#..#..#.#....###...##.
                       |.#...#..#.#.#....#..........#..
                       |..#.#.....#..#...........#.##..
                       |...#.#......#......#..#..#.#...
                       |...#....#.#.#.....#...#.##..#..
                       |.#.#..#...#........##.......#..
                       |##..........#..#...#....###.#..
                       |#.....###......#..#.#.#....#.#.
                       |..###.......#.#...............#
                       |#....#.....#.#......#..##.##...
                       |#.##.#.#....#..#.#...#.#...#..#
                       |#....#..#...........#.......#..
                       |...#.####.....#.........###.##.
                       |......#..#.....#..........#..#.
                       |#...#.#..####...#...#.#.##...##
                       |.##.........#......#.#.#.......
                       |.......##...##.##....###...##..
                       |...#..#....#..#.#.#.....#.#....
                       |#....#.#.#.......##..###..##...
                       |......#............#.#...#..#..
                       |#.#.....#......#...#.......###.
                       |...#.#................#...#....
                       |.....#......#.#..#...##.#.#...#
                       |#....#.#..#..#..##..#.##..#....
                       |#.................#..#....#....
                       |..#....#.......####....###.....
                       |.#..#.#.#...###..#...#..###....
                       |..#..#.#......#.###..........#.
                       |.....#......#.......##....##.#.
                       |.#....#........#.#.##.#........
                       |#.#..##..#..#.#...####....##...
                       |...#....#.#..#...#..........#..
                       |.#.....#.##....#...##..........
                       |....##....#.....#.....#...#.###
                       |.#...##.#.#..##..#...#.#..#..#.
                       |..#.......#.##.....#.#........#
                       |...#...#.....##..#.#.#....#....
                       |...#.....#.......##.........#.#
                       |.##.....#..#.#...#.#...#.#...#.
                       |...........#...#.###..#...#..#.
                       |#.##........#..###.##...####...
                       |.#.....#.#...##...#..#..#...##.
                       |..#....#..#...#.....#.....##...
                       |..###..#.#.....##........#.##..
                       |.#.#..##........#.##....#..#.##
                       |.####.#..##..#.#..#....##....#.
                       |.##....##...#.#........#.......
                       |....#..#..#...#..#..#..#.#.....
                       |...#......................#....
                       |#.....#.#....#..#..#.#..#....#.
                       |##.....#.....##..........###...
                       |.#..#..............#...##.#.#.#
                       |...#...#.#.............#.#..#.#
                       |..#.....#.......#......#.#.....
                       |.###.#..#..#..#.#..#.....#.....
                       |.....##..##...##.......#....###
                       |.#........###...##..#....##....
                       |#....#.#......##..#....#.##..#.
                       |#....#.#...#........##...###...
                       |.#.....#...#.###....#.##.#.####
                       |###......#....#...#....##..#..#
                       |##....#..###......#...#.#.#....
                       |..........#......##.#..#.......
                       |.#..#......###.........##...#..
                       |....#......#....#.........#.#.#
                       |##.#.#...#.#...#...#..#......#.
                       |....#.##.........#..#.....##.#.
                       |........#...#..#.#.#.#.....##..
                       |..#......#.#.#..#.....##.......
                       |..............#....#....##.#..#
                       |....#.#.....#....#.#.###.#....#
                       |..#..........#..#......#.##..#.
                       |...#...#.#.............#..#....
                       |#.......#..#..##.........##..#.
                       |..##..#............#.....#.....
                       |....#.#..##...#.#..#.........#.
                       |........#.......#.##....#....#.
                       |...#.....#.#.....#.#....#......
                       |..#......##.#.............#.#.#
                       |#.#.............#.#.....#......
                       |.##....##.#.....#....#...##....
                       |.#.#....##....#.....##.........
                       |...#.....#.....#.....#..#.###..
                       |.......#....#...##.#...#...#..#
                       |..#.#.......#...###.#...#....#.
                       |.....###..##....###.#.##.......
                       |....#..................##.#.##.
                       |.#.......###.##...#.#.....#....
                       |....#....##...##.....#.#...#..#
                       |#..#.....#......##...#....#....
                       |#..##.........#.....#...#......
                       |...#..##.......##......#..#####
                       |.#..###.###.#.##........#......
                       |.#...#....#....#.#....#...##...
                       |##........#....#.........##..#.
                       |.#.....##............#.#.......
                       |....#....#...........###.....##
                       |.#......#.#.#..#....#.#.....##.
                       |......#.##.#..##....#.#.#..#...
                       |#....#......#...#..####........
                       |......#..#..##..#.......#.#..#.
                       |##....##.###.#...#.##.#..#.###.
                       |.#.........#...##...#.#......#.
                       |..#.#...........####.#....##.##
                       |.....#.#..##.#...###...#..#.#..
                       |...#..#..##.#...#.....#.##...##
                       |..##......##..........#..###...
                       |.#......##.....#.##....#.#.##.#
                       |...#.......##..##.....#....#...
                       |.##...#...#....#..#............
                       |#..#....#...........#..........
                       |......#...#.#.......#...#.##..#
                       |..#.###..#.....#.....#..#.....#
                       |....#....#..........##....#..#.
                       |.......##.#.#.#......#....#...#
                       |####..#.###........#..#......#.
                       |#........##.#.#.#.............#
                       |.#......#......#..#.##.....#...
                       |.....##.##......##.#.....#.#.#.
                       |.......##.#.....##.......#.#.#.
                       |.#.#..#.#..#.##...#.#....#.#..#
                       |.#..##....#..#...##.......#..#.
                       |.#.#..#.......#................
                       |#........#.#.#......#.#.#.#....
                       |##......#...#..##.#...##.##....
                       |##.#..#...........##...#..###..
                       |......#.####...#........#.#.#..
                       |...#........##..###.#.#...#...#
                       |.#.....##..#......##......###..
                       |..#.#...#......#..#..##.#.....#
                       |#....#..#.#..........#...#.....
                       |.#......#.##..###..#.#....#..##
                       |.......#.......#..#..#......#..
                       |..##.....##.#..#..#.....##.....
                       |........#.##...#.#.#..#..#..#..
                       |...#.######.........#.....#..##
                       |.#.#............#....#.........
                       |#...#....###.#......#.#........
                       |#.........#....#...##..........
                       |....#...........#.###.#...###..
                       |.........#........#.#.#..#...#.
                       |.#.......#.#.....#.#.....#.##..
                       |.....#.......#.....#.#.#.......
                       |#.##..#..##.......#...#......#.
                       |.###.....##...##.#...##.##.#.#.
                       |...#......##..##............#.#
                       |...#......................#..##
                       |#..#..#................#...#...
                       |#..#....#.#.#...##.......#..#..
                       |....#.#..###.##...#..#.###..#..
                       |..#...#....####.#............#.
                       |......#....#.#...#.#.#.........
                       |#...#........#.....##..###.#..#
                       |#....#...#...##...#..#....##...
                       |#..#...#..#.......#.#..##.#..#.
                       |#.#..........#...........##....
                       |.#...###...#......#.......#.#.#
                       |.........#.........#...#...##..
                       |##.#..###......##..#.....#..#..
                       |....##...............#.....#...
                       |.....#.....###.#.....#.#.......
                       |....#..#......###..#..##..#....
                       |......................#.....#..
                       |..#..#...##....##....#........#
                       |..#....#...#...#.......#.....#.
                       |...##.#.#.##......#.#.#.#.####.
                       |.###...#..#......#.#..#........
                       |#..#...##.#..#..##..##....#...#
                       |...#...#..#..#..#........#..##.
                       |.##....#.##.#....#...#.#.#....#
                       |#..#....#..#....#.......##..#.#
                       |...#.#....####...........#...#.
                       |#...#####...#.#..#......#...#.#
                       |.##....#.#.#..#......#..##.....
                       |..........#..#.#.#.....##......
                       |.....#....#..................#.
                       |.........#...#...#....#..###...
                       |.#.#.#....#....................
                       |......##............##.###..#..
                       |#.#...#........####.##..#.#.##.
                       |#........#.#.#.#..#.##.....#...
                       |......####..#.##.......#....#..
                       |.........#...#...#.....#.......
                       |..##.....#...#...#.....##.....#
                       |....#...##....#.....#..#..##.##
                       |..#.........##...##..###..#....
                       |#....#.#.........##.###.#...##.
                       |.##...#....#..#..#.#....##.....
                       |##..#..#..#...........#.##....#
                       |....#..........#...#..#.....#..
                       |........###..#..#.#.#.....##...
                       |#...#...#..###............###..
                       |..#.....#.#.#..#..#.#..#......#
                       |..#...##..#....#...#......#....
                       |#....#........##.....#..##....#
                       |#.....#.#.#..#.......##.#.#.##.
                       |..##...#...#.....#..........#..
                       |##.....#....#......#..........#
                       |......#..#..........#.#..####..
                       |......#...#............##...##.
                       |..#.......##.......#...###.###.
                       |.#..#.#.#...#..##.#......#.#...
                       |.##.....##.#.#...#.##.........#
                       |#.#.######...........#.#####.#.
                       |........#.##...##....##.#.##.#.
                       |....#......#.....#.....###...##
                       |#..............#.#....#.#....#.
                       |....#..###.#.........##.#.#....
                       |..#.#.#..##....####..........#.
                       |...#..#.......#................
                       |...#....#..............#....#..
                       |.....#...#...#....#.#.#..#...#.
                       |......##.............###.##..##
                       |.#...#.#..#......#..#.##.......
                       |##.....#.....#.##...#....#.....
                       |..#..#.#.#.#.#..........#..###.
                       |##..........#........#....#.#..
                       |.....#...#........#.#..###....#
                       |.###.#........#.##......#.#...#
                       |#...##....#....#....##.#.#.....
                       |.....#.#............#..........
                       |..#.##....................#....
                       |.....#..#..#.#..#.##.......#...
                       |.....###......#......##......##
                       |#.....#.#.......##.......#...#.
                       |.#.#...#......#..###...#.....#.
                       |#.#..#...#..##.....#...#.#..#..
                       |.....#.#..........#..#.........
                       |.###..##..##.....#...#...#..##.
                       |#...#.#....#.......##..#.......
                       |###...#.#.#..#.......#......#..
                       |....##........#..........##....
                       |............#....#...........#.
                       |#..#.#....##..#.#..#......##...
                       |.###....##...#....##..........#
                       |.###........#........###.....#.
                       |...#...#.#......#...#....#.....
                       |.###.......#.........#.........
                       |....##.#......#...###......##.#
                       |.###...#..##.....##.......#....
                       |.#.#...#..#.##....#........#...""".stripMargin.filter(_ >= ' ')
  val stepsRight = 3

  val firstLineOfPuzzleInput: String= ".#....#..##.#..####....#......."
  val maxInputLengthBeforeRepeating: Int= firstLineOfPuzzleInput.length
  val puzzleArray: Array[Array[Char]]= puzzleInput.toCharArray.grouped(maxInputLengthBeforeRepeating).toArray

  val (res, _) = puzzleArray.drop(1).foldLeft(0, stepsRight){
    case ((count, index), line) => {
      val newIndex = if(line.length <= index)  index - line.length else index
      line(newIndex) match {
        case s: Char if (s =='#') => (count+1, newIndex+stepsRight)
        case _ => (count, newIndex +stepsRight)
      }
    }
  }

  println(res)









}